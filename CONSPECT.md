Натяжка вёрстки на WordPress.

1. В папке wordpress/wp-content/themes создать каталог создаваемой темы.
2. В папке темы создать файл style.css
   Добавить в style.css комментарий, содержащий название темы:

   /*Theme Name: Название темы*/

   Этот комментарий может содержать и другие сведения.
   За образец можно взять комментарий из встроенной темы WordPress.
3. В папке темы создать файл index.php (точка входа в приложение - главная страница).
4. Эти действия приведут к регистрации темы в WordPress. При заходе на главную страницу сайта будет открываться пустая
   страница.
5. Скопировать содержимое файла index.html в файл index.php.
6. Внутри папки темы создать каталог assets, в котором будут храниться дополнительные файлы: картинки, шрифты, стили,
   скрипты.
   Общие стили сайта должны храниться в файле style.css, хранящемся в каталоге темы.
   В каталоге assets должны храниться редко используемые файлы или файлы библиотек.
7. Скопировать файлы шрифтов, стилей, скриптов и картинок вёрстки в папку assets.
   Настроить динамическое подключение этих файлов.
   Общие стили сайта переместить в файл style.css, хранящийся в каталоге темы.
8. Подключить стандартные (WordPress) и пользовательские стили и скрипты с помощью вызова функции wp_head().
   Перед закрывающим тегом </head> добавить строку
   <?php wp_head();?>
9. Чтобы вызов функции wp_head() подключал не только стандартные, но и пользовательские стили и скрипты,
   нужно создать файл functions.php в каталоге темы.
   В WordPress регистрация стилей и скриптов производится динамически с помощью хуков,
   поэтому нужно удалить статические ссылки подключения стилей и скриптов из index.php,
   т.к. они работать не будут.
10. В файле functions.php описать действия, которые должны происходить при определённых событиях,
    с помощью вызова функции add_action('wp_enqueue_scripts', 'theme_scripts'), которая принимает
    строку с названием хука ('wp_enqueue_scripts') и
    строку с названием функции ('theme_scripts'), которая будет им вызываться.
    wp_enqueue_scripts - момент подключения стандартных скриптов и стилей.
    Функцию, выполняющую определённые действия при срабатывании хука, необходимо объявить ниже:
    function theme_scripts(){
    wp_enqueue_style('theme-style', get_stylesheet_uri());
    wp_enqueue_style('header-style', get_template_directory_uri() . '/assets/styles/main.min.css');
    }

    wp_enqueue_style служит для подключения стилей и принимает
    строку с названием файла стилей -'theme-style'
    путь к файлу стилей, хранящемуся в каталоге темы, возвращаемый функцией get_stylesheet_uri()

Идеальным является вариант, при котором пользовательские файлы стилей и файлы библиотек объединены в один файл и
минифицированы,
но иногда требуется динамическое подключение файлов.
Если требуется подключить несколько файлов, то вызвать wp_enqueue_style нужно для каждого из них.
Для получения пути к корневому каталогу темы без '/' в конце служит функция get_template_directory_uri().
Сформировать путь к файлу, хранящемуся в каталоге assets, можно с помощью конкатенации.

Пример подключения библиотеки из CDN:

    wp_enqueue_style('animate-style', 'https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css');

Название 'animate-style' является произвольным.
В данном случае оно участвует только в формировании id тега link, подключающего стили.

11. Удалить из index.php тег <script> перед закрывающим тегом </body>.
12. Вместо тега <script> перед закрывающим тегом </body> вставить вызов функции wp_footer().

   <?php wp_footer(); ?>

13. Хук wp_enqueue_scripts отслеживает подключение не только стилей, но и скриптов JS,
    поэтому в функцию theme_scripts, описанную выше, можно добавить строку,
    вызывающую подключение скриптов JS, или создать отдельные функцию и действие её вызывающее (add_action).
    JS скрипты подключаются вызовом функции wp_enqueue_script, которая принимает
    строку с названием файла ('theme-scripts'),
    строку, содержащую путь к JS-файлу,
    массив зависимостей данного скрипта (файлов, которые должны быть загружены до его запуска, например, сторонних
    библиотек),
    версию скрипта (string|boolean|null),
    $in_footer:boolean - место подключения скрипта: по умолчанию true (в footer) или false (в header).

    wp_enqueue_script('theme-scripts', get_template_directory_uri() . '/assets/js/main.min.js', [],null, true);

14. Если приходится подключать много различных файлов, то подключение стилей и скриптов JS следует выполнять в отдельных
    действиях (add_action) для улучшения наглядности.
15. bloginfo($show) - выводит информацию о сайте или блоге. Относится к тегам шаблона.
    Работает на основе get_bloginfo().
    Если не указать параметр $show - выведет название блога.

    bloginfo('template_url') возвращает url каталога текущей темы, но, согласно документации,
    лучше использовать get_template_directory().

Вызов bloginfo также позволяет получить в шаблоне url файла стилей, кодировку сайте, текущую локаль и др..

16. Произвести замену путей к файлам в index.php:
    ./img заменить на <?= bloginfo('template_url'); ?>/assets/img

16. Произвести замену путей к файлам в style.css:
    ../img заменить на /assets/img
    ../fonts заменить на /assets/fonts

------------------------------------------------------------------------------------------------------------------------

                    Правильная структура темы WordPress

------------------------------------------------------------------------------------------------------------------------

Для генерации правильной структуры темы WordPress следует использовать сайт
https://underscores.me/    
При использовании генератора важно правильно назвать создаваемую тему,
т.к. получаемые файлы будут использовать это название (404 и т.п.).
Сгенерированный шаблон можно сразу помещать в wordpress/wp-content/themes.

------------------------------------------------------------------------------------------------------------------------

17. В корневом каталоге темы создать файл header.php,
    в который поместить вёрстку от <!DOCTYPE html> до закрывающего тега </header>, вырезанную из index.php.
18. Для динамического подключения header.php на страницу сайта
    в верхнюю строку index.php вставить <?php get_header(); ?>

19. В корневом каталоге темы создать файл footer.php,
    в который поместить вёрстку всех повторяющихся в нижней части разных страниц элементов:
    не только <footer>, но и модальных окон и т.п., до закрывающего тега </html>.
20. Для динамического подключения header.php на страницу сайта
    в нижнюю строку index.php вставить <?php get_footer(); ?>

------------------------------------------------------------------------------------------------------------------------

                    Хуки WordPress

------------------------------------------------------------------------------------------------------------------------
В WordPress имеется более 2000 хуков.
https://wp-kama.ru/hooks/hooks-db

Хуками WordPress называются события (action) и фильтры (filter).
Хуки - это действия которые выполняются во время определённых действий (событий).
Все хуки в WordPress делятся на фильтры и действия (события).

Фильтры служат для выделения какого-то передаваемого значения.
Фильтр получает значение и должен его вернуть.
Пример:
при формировании страницы динамически будет формироваться и меню в header.
Когда меню будет сформировано WordPress сформирует событие,
свидетельствующее о том, что меню готово.
В этот момент можно перехватить все элементы меню и их отфильтровать.
Например, добавить каждому элементу меню класс, указывающий на его активность.

События - возникают в определённый момент и ничего не возвращают,
например, событие подключения скриптов - wp_enqueue_scripts.

Ко всем хукам, как фильтрам, так и к событиям, должна прикрепляться функция, которой можно передавать аргументы.
На основе полученных аргументов логика работы функции может изменяться.

С помощью вызова функции add_action('hook_name','function_name')
можно подписаться на событие 'hook_name'.
Когда оно произойдёт, будет вызвана функция 'function_name'.

Сгенерировать событие в WordPress можно с помощью вызова функции do_action('hook_name')
do_action('my_hook');

add_action($tag, $function, $priority, $accepted_args) принимает парамерами
    $tag: string - название отслеживаемого действия (события)
    $function: string - название вызываемой при возникновении события функции
    $priority: number - приоритет выполнения функции (их может быть нацелено на хук несколько)
    - чем меньше, тем раньше выполняется.
    $accepted_args: number - количество аргументов, принимаемых функцией.

do_action('my_hook') всегда должна располагаться в коде ниже,
чем add_action('hook_name','function_name')


Чтобы генерировать кастомное событие,
можно добавлять вызов do_action('my_hook') в шаблоне темы.
А подписываться на него с помощью вызова add_action('hook_name','function_name')
в файле functions.php.


---
По умолчанию количество аргументов, принимаемых функцией-обработчиком события равно одному, поэтому
если функция-обработчик принимает один аргумент,
то указывать их количество в вызове add_action или add_filter не нужно.
Чтобы использовать аргументы в функции-обработчике события нужно указать их количество в вызове функции add_action,
и передать их значения в вызове функции do_action.

function print_hello ($text, $name){
    echo 'Hello' . $name . </br>;
    echo $text;
}
add_action('my_hook', 'print_hello', 10, 2); где 2 - количество аргументов функции-обработчика
do_action('my_hook', 'Good job!', 'Alex');
---


Для регистрации фильтра в WordPress служит функция add_filter(),
которая имеет такую же сигнатуру, как и add_action().
Для вызова функции-обработчика, зарегистрированной в add_filter()
служит функция apply_filters(), сигнатура которой схожа с do_action().
 
Отличием фильтров от действий является необходимость вернуть результат.

Пример фильтра WordPress:
function my_filter_function($str){
    return 'Hello,' . $str;
}
add_filter('my_filter', 'my_filter_function');
echo apply_filters('my_filter', 'friend');


Для отмены подписки на событие для действий служит функция
    remove_action($hook, $func, $priority)
        $hook: string - название события
        $func: string - название функции-обработчика
        $priority: number - приоритет

Для отмены подписки на событие для фильтров служит функция
    remove_filters($hook, $func, $priority)

Чтобы подписка отменилась, обязательно нужно указывать тот же приоритет,
что и в подписке.
Не требуется указывать только значение приоритета по умолчанию (10).
    


------------------------------------------------------------------------------------------------------------------------

