Натяжка вёрстки на WordPress.

1. В папке wordpress/wp-content/themes создать каталог создаваемой темы.
2. В папке темы создать файл style.css
   Добавить в style.css комментарий, содержащий название темы:

   /*Theme Name: Название темы*/

   Этот комментарий может содержать и другие сведения.
   За образец можно взять комментарий из встроенной темы WordPress.
3. В папке темы создать файл index.php (точка входа в приложение - главная страница).
4. Эти действия приведут к регистрации темы в WordPress. При заходе на главную страницу сайта будет открываться пустая
   страница.
5. Скопировать содержимое файла index.html в файл index.php.
6. Внутри папки темы создать каталог assets, в котором будут храниться дополнительные файлы: картинки, шрифты, стили,
   скрипты.
   Общие стили сайта должны храниться в файле style.css, хранящемся в каталоге темы.
   В каталоге assets должны храниться редко используемые файлы или файлы библиотек.
7. Скопировать файлы шрифтов, стилей, скриптов и картинок вёрстки в папку assets.
   Настроить динамическое подключение этих файлов.
   Общие стили сайта переместить в файл style.css, хранящийся в каталоге темы.
8. Подключить стандартные (WordPress) и пользовательские стили и скрипты с помощью вызова функции wp_head().
   Перед закрывающим тегом </head> добавить строку
   <?php wp_head();?>
9. Чтобы вызов функции wp_head() подключал не только стандартные, но и пользовательские стили и скрипты,
   нужно создать файл functions.php в каталоге темы.
   В WordPress регистрация стилей и скриптов производится динамически с помощью хуков,
   поэтому нужно удалить статические ссылки подключения стилей и скриптов из index.php,
   т.к. они работать не будут.
10. В файле functions.php описать действия, которые должны происходить при определённых событиях,
    с помощью вызова функции add_action('wp_enqueue_scripts', 'theme_scripts'), которая принимает
    строку с названием хука ('wp_enqueue_scripts') и
    строку с названием функции ('theme_scripts'), которая будет им вызываться.
    wp_enqueue_scripts - момент подключения стандартных скриптов и стилей.
    Функцию, выполняющую определённые действия при срабатывании хука, необходимо объявить ниже:
    function theme_scripts(){
    wp_enqueue_style('theme-style', get_stylesheet_uri());
    wp_enqueue_style('header-style', get_template_directory_uri() . '/assets/styles/main.min.css');
    }

    wp_enqueue_style служит для подключения стилей и принимает
    строку с названием файла стилей -'theme-style'
    путь к файлу стилей, хранящемуся в каталоге темы, возвращаемый функцией get_stylesheet_uri()

Идеальным является вариант, при котором пользовательские файлы стилей и файлы библиотек объединены в один файл и
минифицированы,
но иногда требуется динамическое подключение файлов.
Если требуется подключить несколько файлов, то вызвать wp_enqueue_style нужно для каждого из них.
Для получения пути к корневому каталогу темы без '/' в конце служит функция get_template_directory_uri().
Сформировать путь к файлу, хранящемуся в каталоге assets, можно с помощью конкатенации.

Пример подключения библиотеки из CDN:

    wp_enqueue_style('animate-style', 'https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css');

Название 'animate-style' является произвольным.
В данном случае оно участвует только в формировании id тега link, подключающего стили.

11. Удалить из index.php тег <script> перед закрывающим тегом </body>.
12. Вместо тега <script> перед закрывающим тегом </body> вставить вызов функции wp_footer().

   <?php wp_footer(); ?>

13. Хук wp_enqueue_scripts отслеживает подключение не только стилей, но и скриптов JS,
    поэтому в функцию theme_scripts, описанную выше, можно добавить строку,
    вызывающую подключение скриптов JS, или создать отдельные функцию и действие её вызывающее (add_action).
    JS скрипты подключаются вызовом функции wp_enqueue_script, которая принимает
    строку с названием файла ('theme-scripts'),
    строку, содержащую путь к JS-файлу,
    массив зависимостей данного скрипта (файлов, которые должны быть загружены до его запуска, например, сторонних
    библиотек),
    версию скрипта (string|boolean|null),
    $in_footer:boolean - место подключения скрипта: по умолчанию true (в footer) или false (в header).

    wp_enqueue_script('theme-scripts', get_template_directory_uri() . '/assets/js/main.min.js', [],null, true);

14. Если приходится подключать много различных файлов, то подключение стилей и скриптов JS следует выполнять в отдельных
    действиях (add_action) для улучшения наглядности.
15. bloginfo($show) - выводит информацию о сайте или блоге. Относится к тегам шаблона.
    Работает на основе get_bloginfo().
    Если не указать параметр $show - выведет название блога.

    bloginfo('template_url') возвращает url каталога текущей темы, но, согласно документации,
    лучше использовать get_template_directory().

Вызов bloginfo также позволяет получить в шаблоне url файла стилей, кодировку сайте, текущую локаль и др..

16. Произвести замену путей к файлам в index.php:
    ./img заменить на <?= bloginfo('template_url'); ?>/assets/img

16. Произвести замену путей к файлам в style.css:
    ../img заменить на /assets/img
    ../fonts заменить на /assets/fonts

------------------------------------------------------------------------------------------------------------------------

                    Правильная структура темы WordPress

------------------------------------------------------------------------------------------------------------------------

Для генерации правильной структуры темы WordPress следует использовать сайт
https://underscores.me/    
При использовании генератора важно правильно назвать создаваемую тему,
т.к. получаемые файлы будут использовать это название (404 и т.п.).
Сгенерированный шаблон можно сразу помещать в wordpress/wp-content/themes.

------------------------------------------------------------------------------------------------------------------------

17. В корневом каталоге темы создать файл header.php,
    в который поместить вёрстку от <!DOCTYPE html> до закрывающего тега </header>, вырезанную из index.php.
18. Для динамического подключения header.php на страницу сайта
    в верхнюю строку index.php вставить <?php get_header(); ?>

19. В корневом каталоге темы создать файл footer.php,
    в который поместить вёрстку всех повторяющихся в нижней части разных страниц элементов:
    не только <footer>, но и модальных окон и т.п., до закрывающего тега </html>.
20. Для динамического подключения header.php на страницу сайта
    в нижнюю строку index.php вставить <?php get_footer(); ?>

------------------------------------------------------------------------------------------------------------------------

                    Хуки WordPress

------------------------------------------------------------------------------------------------------------------------
В WordPress имеется более 2000 хуков.
https://wp-kama.ru/hooks/hooks-db

Хуками WordPress называются события (action) и фильтры (filter).
Хуки - это действия которые выполняются во время определённых действий (событий).
Все хуки в WordPress делятся на фильтры и действия (события).

Фильтры служат для выделения какого-то передаваемого значения.
Фильтр получает значение и должен его вернуть.
Пример:
при формировании страницы динамически будет формироваться и меню в header.
Когда меню будет сформировано WordPress сформирует событие,
свидетельствующее о том, что меню готово.
В этот момент можно перехватить все элементы меню и их отфильтровать.
Например, добавить каждому элементу меню класс, указывающий на его активность.

События - возникают в определённый момент и ничего не возвращают,
например, событие подключения скриптов - wp_enqueue_scripts.

Ко всем хукам, как фильтрам, так и к событиям, должна прикрепляться функция, которой можно передавать аргументы.
На основе полученных аргументов логика работы функции может изменяться.

С помощью вызова функции add_action('hook_name','function_name')
можно подписаться на событие 'hook_name'.
Когда оно произойдёт, будет вызвана функция 'function_name'.

Сгенерировать событие в WordPress можно с помощью вызова функции do_action('hook_name')
do_action('my_hook');

add_action($tag, $function, $priority, $accepted_args) принимает парамерами
    $tag: string - название отслеживаемого действия (события)
    $function: string - название вызываемой при возникновении события функции
    $priority: number - приоритет выполнения функции (их может быть нацелено на хук несколько)
    - чем меньше, тем раньше выполняется.
    $accepted_args: number - количество аргументов, принимаемых функцией.

do_action('my_hook') всегда должна располагаться в коде ниже,
чем add_action('hook_name','function_name')


Чтобы генерировать кастомное событие,
можно добавлять вызов do_action('my_hook') в шаблоне темы.
А подписываться на него с помощью вызова add_action('hook_name','function_name')
в файле functions.php.


---
По умолчанию количество аргументов, принимаемых функцией-обработчиком события равно одному, поэтому
если функция-обработчик принимает один аргумент,
то указывать их количество в вызове add_action или add_filter не нужно.
Чтобы использовать аргументы в функции-обработчике события нужно указать их количество в вызове функции add_action,
и передать их значения в вызове функции do_action.

function print_hello ($text, $name){
    echo 'Hello' . $name . </br>;
    echo $text;
}
add_action('my_hook', 'print_hello', 10, 2); где 2 - количество аргументов функции-обработчика
do_action('my_hook', 'Good job!', 'Alex');
---


Для регистрации фильтра в WordPress служит функция add_filter(),
которая имеет такую же сигнатуру, как и add_action().
Для вызова функции-обработчика, зарегистрированной в add_filter()
служит функция apply_filters(), сигнатура которой схожа с do_action().
 
Отличием фильтров от действий является необходимость вернуть результат.

Пример фильтра WordPress:
function my_filter_function($str){
    return 'Hello,' . $str;
}
add_filter('my_filter', 'my_filter_function');
echo apply_filters('my_filter', 'friend');


Для отмены подписки на событие для действий служит функция
    remove_action($hook, $func, $priority)
        $hook: string - название события
        $func: string - название функции-обработчика
        $priority: number - приоритет

Для отмены подписки на событие для фильтров служит функция
    remove_filters($hook, $func, $priority)

Чтобы подписка отменилась, обязательно нужно указывать тот же приоритет,
что и в подписке.
Не требуется указывать только значение приоритета по умолчанию (10).
    
------------------------------------------------------------------------------------------------------------------------

21. Перейти на страницу настройки темы: Внешний вид/Темы/Настроить/Свойства сайта/.
Кнопка "Выбрать логотип" будет отсутствовать.
22. В файле functions.php включить поддержку custom-logo у темы:
         add_theme_support( 'custom-logo' ),
чтобы можно было установить логотип в кастомайзере.
23. Обновить страницу настроек темы со сбросом кеша браузера (shift+F5).
24. Убедиться, что Кнопка "Выбрать логотип" появилась.
25. Вывести на экран HTML код логотипа сайта, установленного в кастомайзере (настройках темы),
вызовом функции the_custom_logo() в header-шаблоне сайта.
    the_custom_logo() - обертка для конструкции: echo get_custom_logo( $blog_id );,
      $blog_id - ID сайта/блога, логотип которого нужно получить.
    1) Заменить тег <a>, ведущий на главную страницу и выводящий
       логотип в шаблон на <div>,и его содержимое на (важно не забыть убрать атрибут href, оставшийся от тега <a>:
        <div class="header__logo">
             <?php the_custom_logo() ?>
         </div>
    2) Нажать кнопку "Выбрать логотип".
    3) Перетащить файл логотипа в формате png на вкладку "Загрузить файлы".
    4) Выбрать загруженный логотип из вкладки "Библиотека файлов".
    5) Заполнить "Параметры файла" в правой части окна. Для всех использующихся картинок обязательно нужно заполнять 
       "Атрибут alt" - это необходимо для SEO-оптимизации.
    6) Можно обрезать выбранное изображение.
    7) Нажать кнопку "Опубликовать".
Эти настройки приведут к тому, что ссылка на логотип будет храниться в БД и изменяться из панели администратора.
Чтобы при смене логотипа вёрстка не ломалась нужно использовать файлы png и правильно задать стили логотипа.
Существует другой вариант внедрения логотипа в шаблон (без замены тега <a> на <div>).
26. В этом случае нужно заменить содержимое тега <a> на <img src="">. Для получения ссылки на логотип следует 
    использовать функцию (https://wp-kama.ru/function/get_custom_logo):
    <a href="<?= get_home_url(); ?>" class="header__logo">
      <img src="<?= wp_get_attachment_image_src(get_theme_mod('custom_logo'), 'full')[0]; ?>"
           alt="Мир детства"
           class="header__logo-img">
      <div class="header__logo-text">Мир детства</div>
    </a>
Для получения ссылки на главную страницу сайта использована функция get_home_url().
27. Настроить вывод логотипа в footer-шаблоне сайта, заменив тег <a> на <div>.
29. Вывести заголовок сайта в header-шаблоне:
    <title>
      <?php bloginfo('name'); ?>
      <?= '|' ?>
      <?php bloginfo('description'); ?>
    </title>
30. Вывести заголовок первого уровня:
    <h1 class="title underlined">
        <?php bloginfo('name'); ?>
    </h1>
31. Установить плагин Advanced Custom Fields (ACF).
Расширенные настраиваемые поля превращают сайты WordPress в полноценную систему управления контентом,
предоставляя вам все инструменты для работы с вашими данными.
В панели администратора под пунктом "Настройи" появится пункт "ACF" или "Группы полей".
ACF использует группы полей для группировки произвольных полей вместе, а затем присоединяет эти поля к экранным формам редактирования.
32. Создать новую группу полей.
Перейти на вкладку "ACF" "Группы полей", блок "Настройки", вкладка "Правила местонахождения".
Выбрать настройки для "Отображать группу полей, если"
(Тип страницы)(равно)(Главная страница)
Это приведёт к тому, что поля, относящиеся к этой группе будут отображаться только на главной странице.
На вкладке "Презентация" расположены настройки отображения полей.
33. Добавить поле в активную группу полей нажатием кнопки в правом верхнем углу.
           Заполнить поля формы.
    Вкладка "Общие"
"Тип поля" - тип данных столбца в БД?
При заполнении "Этикетки поля" WordPress автоматически сгенерирует "Название поля". Использовать кириллицу в "Названии поля" недопустимо. Вероятно, "Название поля" - это название столбца в БД.
"Значение по умолчанию" - Появляется при создании новой записи

    Вкладка "Валидация"
"Обязательное" - boolean (чекбокс)
"Ограничение кол-ва символов" number

    Вкладка "Презентация"
"Инструкции" - Инструкция для авторов. Отображается при отправке данных
"Текст-заполнитель" - placeholder
"Добавить в начало" - before?
"Добавить" - after?
"Атрибуты обёртки" - width, class, id
"Новые строки" - (<br>, <p>, без форматирования)

Вкладка "Условная логика"
Позволяет добавить правила отображения поля

Если выбрать значения "Типа поля" - "Изображение",
появится возможность выбора
"Формата возврата" - (Массив изображения, URL изображения, ID изображения)
Самый простой вариант "Формата возврата" - "URL изображения".
Для "Типа поля" - "Изображение" во вкладке "Презентация" доступно свойство "Размер предпросмотра", а во вкладке 
"Валидация" - "Разрешенные типы файлов"
Чтобы сохранить изменения в БД обязательно нужно нажимать кнопку "Сохранить изменения" в правом верхнем углу экрана.

34. Перейти в "Настройки"/"Чтение"
Чтобы на странице правильно отображались кастомные поля, в свойстве
"На главной странице отображать" нужно выбрать " Статическую страницу" и указать конкретную страницу из выпадающего 
    списка.
Сохранить изменения.
35. Перейти в меню "Страницы".
В нём отображается список существующих страниц сайта.
Выбрав страницу, можно её изменить.
После создания страницы на ней будут размещены стандартные "заглушки" от WordPress, которые можно удалить через меню, появляющееся при выборе блока.

При начале работы с новой страницей сайта стандартные "заглушки" WordPress нужно удалить, оставив только заголовок.
Также нужно заполнить дополнительные поля, которые отображаются во вкладке "Страница". На "Главной" странице будут 
доступны ACF "О компании", созданные ранее, т.к. для их отображения выполнилось условие (текущая страница является 
главной).
После редактирования страницы нужно обязательно нажать кнопку "Обновить".
36. Чтобы изменения отобразились на странице сайта, необходимо внести изменения в вёрстку.
1) Заменить содержимое тега <h1> в файле index.php на следующее:
    <h1 class="title underlined">
        <?php the_field('about_title'); ?>
    </h1>
the_field - функция, возвращающая значение поля,
about_title - название кастомного поля, в котором хранится заголовок первого уровня.

2) Заменить содержимое блока описания о компании на следующее:
   <div class="about__text">
        <?php the_field('about_description'); ?>
   </div>

3) Заменить содержимое блока с изображением на следующее:
   <div class="about__img">
    <img src="<?= the_field('about_image') ?>"
        alt="<?php the_field('about_title'); ?>">
   </div>